<!DOCTYPE html>
<html lang="pl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Umiejƒôtno≈õci Szachowych - Pionek "ADEPT"</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 40px;
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 10px;
            font-size: 2.2em;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }

        .section h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .question {
            margin-bottom: 20px;
        }

        .question label {
            display: block;
            margin-bottom: 8px;
            color: #444;
            font-weight: 500;
        }

        select {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            background: white;
            cursor: pointer;
            transition: border-color 0.3s;
        }

        select:hover {
            border-color: #667eea;
        }

        select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .submit-btn {
            display: block;
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .submit-btn:active {
            transform: translateY(0);
        }

        /* Nowe style nag≈Ç√≥wka */
        .header-top {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 30px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .header-info {
            display: flex;
            flex-direction: column;
            gap: 20px;
            text-align: left;
        }

        .student-box {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .student-box label {
            font-weight: bold;
            color: #333;
        }

        .student-box input {
            padding: 10px;
            border: 2px solid #667eea;
            border-radius: 8px;
            font-size: 1.1em;
            outline: none;
        }

        .rank-title {
            font-weight: bold;
            font-size: 1.25em;
            color: #764ba2;
        }

        .rank-subtitle {
            font-size: 0.9em;
            color: #666;
        }

        .badge-header {
            position: relative;
            width: 150px;
            height: 180px;
            flex-shrink: 0;
            margin: 10px 0;
        }

        .badge-header img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            position: absolute;
            top: 0;
            left: 0;
            z-index: 0;
            display: block;
        }

        .anim-grid {
            position: absolute;
            top: 65%;
            left: 48%;
            transform: translate(-50%, -50%);
            width: 87px;
            height: 87px;
            z-index: 1;
        }

        .anim-cell {
            position: absolute;
            width: 9px;
            height: 9px;
            background: transparent;
            border-radius: 50%;
            transition: all 0.35s ease;
        }

        /* Pozycjonowanie po ≈Çuku wok√≥≈Ç pionka */
        .anim-cell:nth-child(1) {
            top: 35%;
            left: 16%;
        }

        .anim-cell:nth-child(2) {
            top: 52%;
            left: 12%;
        }

        .anim-cell:nth-child(3) {
            top: 69%;
            left: 18%;
        }

        .anim-cell:nth-child(4) {
            top: 82%;
            left: 32%;
        }

        .anim-cell:nth-child(5) {
            top: 87%;
            left: 50%;
        }

        .anim-cell:nth-child(6) {
            top: 82%;
            left: 68%;
        }

        .anim-cell:nth-child(7) {
            top: 69%;
            left: 82%;
        }

        .anim-cell:nth-child(8) {
            top: 52%;
            left: 88%;
        }

        .anim-cell:nth-child(9) {
            top: 35%;
            left: 84%;
        }

        .anim-cell.lit {
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
            border: 1px solid #B8860B;
            box-shadow: 0 0 8px rgba(255, 215, 0, 0.8), 0 0 3px rgba(255, 165, 0, 0.6);
        }

        #results {
            margin-top: 30px;
            padding: 30px;
            background: linear-gradient(135deg, #f6f8fb 0%, #e9ecef 100%);
            border-radius: 15px;
            display: none;
        }

        .result-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .level-badge {
            font-size: 3em;
            font-weight: bold;
            color: #667eea;
            margin: 10px 0;
        }

        .badge-container {
            display: flex;
            justify-content: center;
            margin: 30px 0;
        }

        .badge-visual {
            position: relative;
            width: 300px;
            height: 360px;
        }

        .badge-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        /* Uk≈Çad punkt√≥w dla wynik√≥w - taki sam jak w nag≈Ç√≥wku */
        .badge-visual .anim-grid {
            position: absolute;
            top: 65%;
            left: 48%;
            transform: translate(-50%, -50%);
            width: 174px;
            /* 87px * 2 dla wiƒôkszej odznaki */
            height: 174px;
            z-index: 1;
        }

        .badge-visual .anim-cell {
            position: absolute;
            width: 18px;
            /* 9px * 2 */
            height: 18px;
            background: transparent;
            border-radius: 50%;
            transition: all 0.35s ease;
        }

        /* Pozycjonowanie po ≈Çuku - takie same proporcje jak w nag≈Ç√≥wku */
        .badge-visual .anim-cell:nth-child(1) {
            top: 35%;
            left: 16%;
        }

        .badge-visual .anim-cell:nth-child(2) {
            top: 52%;
            left: 12%;
        }

        .badge-visual .anim-cell:nth-child(3) {
            top: 69%;
            left: 18%;
        }

        .badge-visual .anim-cell:nth-child(4) {
            top: 82%;
            left: 32%;
        }

        .badge-visual .anim-cell:nth-child(5) {
            top: 87%;
            left: 50%;
        }

        .badge-visual .anim-cell:nth-child(6) {
            top: 82%;
            left: 68%;
        }

        .badge-visual .anim-cell:nth-child(7) {
            top: 69%;
            left: 82%;
        }

        .badge-visual .anim-cell:nth-child(8) {
            top: 52%;
            left: 88%;
        }

        .badge-visual .anim-cell:nth-child(9) {
            top: 35%;
            left: 84%;
        }

        .badge-visual .anim-cell.lit {
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
            border: 1px solid #B8860B;
            box-shadow: 0 0 16px rgba(255, 215, 0, 0.8), 0 0 6px rgba(255, 165, 0, 0.6);
        }

        @keyframes glow {

            0%,
            100% {
                box-shadow: 0 0 15px rgba(255, 215, 0, 0.6);
            }

            50% {
                box-shadow: 0 0 25px rgba(255, 215, 0, 0.9);
            }
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }

        .stat-label {
            color: #666;
            font-size: 0.9em;
            margin-top: 5px;
        }

        .improvement-section {
            margin-top: 30px;
            padding: 20px;
            background: white;
            border-radius: 10px;
        }

        .improvement-section h3 {
            color: #333;
            margin-bottom: 15px;
        }

        .improvement-option {
            margin: 15px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #28a745;
        }

        .improvement-option h4 {
            color: #28a745;
            margin-bottom: 10px;
        }

        .weakness-list {
            background: #fff3cd;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #ffc107;
            margin: 15px 0;
        }

        .weakness-list h4 {
            color: #856404;
            margin-bottom: 10px;
        }

        .weakness-list ul {
            margin-left: 20px;
        }

        .weakness-list li {
            color: #856404;
            margin: 5px 0;
        }

        .category-results {
            margin: 20px 0;
        }

        .category-bar {
            margin: 10px 0;
        }

        .category-name {
            font-weight: 500;
            color: #333;
            margin-bottom: 5px;
        }

        .bar-container {
            width: 100%;
            height: 30px;
            background: #e9ecef;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }

        .bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 1s ease;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 10px;
            color: white;
            font-weight: bold;
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
            font-size: 0.9em;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .legend-box {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }

        /* Przyciski akcji */
        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
            padding: 20px;
        }

        .action-btn {
            padding: 12px 30px;
            font-size: 1.1em;
            font-weight: bold;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-reset {
            background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
            color: white;
        }

        .btn-reset:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(108, 117, 125, 0.4);
        }

        .btn-save {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
        }

        .btn-save:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.4);
        }

        /* Style druku */
        @media print {
            body {
                background: white;
                padding: 0;
            }

            .container {
                box-shadow: none;
                max-width: 100%;
            }

            .action-buttons {
                display: none;
            }

            #examForm {
                display: none;
            }

            h1 {
                page-break-after: avoid;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>üèÜ Test Umiejƒôtno≈õci Szachowych</h1>

        <div class="header-top">
            <div class="header-info">
                <div class="rank-box">
                    <div class="rank-title">Ranga: ADEPT Magii Szachowej</div>
                    <div class="rank-subtitle">Poziomy do zdobycia 1-9</div>
                </div>

                <div class="student-box">
                    <label for="studentName">Imiƒô:</label>
                    <input type="text" id="studentName" name="student_name" placeholder="Wpisz swoje imiƒô...">
                </div>
            </div>

            <div class="badge-header">
                <img src="przypinka_clear.png" alt="Odznaka" class="main-badge">
                <div class="anim-grid" id="animGrid">
                    <div class="anim-cell"></div>
                    <div class="anim-cell"></div>
                    <div class="anim-cell"></div>
                    <div class="anim-cell"></div>
                    <div class="anim-cell"></div>
                    <div class="anim-cell"></div>
                    <div class="anim-cell"></div>
                    <div class="anim-cell"></div>
                    <div class="anim-cell"></div>
                </div>
            </div>
        </div>

        <form id="examForm">
            <!-- Sekcja 1: Szachownica -->
            <div class="section">
                <h3>üìã Szachownica i jej w≈Ça≈õciwo≈õci</h3>
                <div style="font-size: 0.9em; margin-bottom: 15px;">
                    <b>Jak nie wiesz, to kliknij tu =></b> <a href="https://lichess.org/training/coordinate"
                        target="_blank"
                        style="color: #667eea; text-decoration: none; font-size: 1.5em; vertical-align: middle;"
                        title="Lichess Coordinate Training">‚ôû</a>
                </div>
                <div class="question">
                    <label>Ile p√≥l znajdziesz w 30s?</label>
                    <select name="board_fields" required style="width: 50%;">
                        <option value="">Wybierz...</option>
                        <option value="0">0-4 pola</option>
                        <option value="1">5-6 p√≥l (Poziom 3)</option>
                        <option value="2">7-8 p√≥l (Poziom 4)</option>
                        <option value="3">9-10 p√≥l (Poziom 5)</option>
                        <option value="4">11-12 p√≥l (Poziom 6)</option>
                        <option value="5">13-14 p√≥l (Poziom 7)</option>
                        <option value="6">15+ p√≥l (Poziom 9)</option>
                    </select>

                </div>
                <div class="question">
                    <label>Znajomo≈õƒá nazw p√≥l i przekƒÖtnych:</label>
                    <select name="board_knowledge" required style="width: 50%;">
                        <option value="">Wybierz...</option>
                        <option value="1">Znam kolumny i rzƒôdy (Poziom 1)</option>
                        <option value="2">Znam przekƒÖtne i kolory p√≥l (Poziom 2)</option>
                        <option value="3">Wymieniam pola na liniach pionowych (Poziom 3)</option>
                        <option value="6">Znam kolory wszystkich p√≥l (Poziom 8)</option>
                    </select>
                </div>
            </div>

            <!-- Sekcja 2: Figury - Goniec -->
            <div class="section">
                <h3>‚ôó Goniec</h3>
                <div style="font-size: 0.9em; margin-bottom: 15px;">
                    <b>Jak nie wiesz, to kliknij tu =></b> <a href="https://lichess.org/learn#/2" target="_blank"
                        style="color: #667eea; text-decoration: none; font-size: 1.5em; vertical-align: middle;"
                        title="Lichess Bishop Tutorial">‚ôó</a>
                </div>
                <div class="question">
                    <label>≈Åamig≈Ç√≥wki z biciem go≈Ñcem:</label>
                    <select name="bishop_puzzles" required style="width: 50%;">
                        <option value="">Wybierz...</option>
                        <option value="1">RozwiƒÖzujƒô na 4 ruchy (Poziom 2)</option>
                        <option value="2">RozwiƒÖzujƒô na 5 ruch√≥w (Poziom 3)</option>
                        <option value="3">RozwiƒÖzujƒô na 6 ruch√≥w (Poziom 4)</option>
                        <option value="4">RozwiƒÖzujƒô na 7 ruch√≥w (Poziom 5)</option>
                        <option value="5">RozwiƒÖzujƒô na 8+ ruch√≥w (Poziom 6)</option>
                    </select>
                </div>
                <div class="question">
                    <label>Gra "UciekajƒÖca figura" - ile p√≥l zapamiƒôtasz?</label>
                    <select name="bishop_memory" required style="width: 50%;">
                        <option value="">Wybierz...</option>
                        <option value="1">1 pole (Poziom 1)</option>
                        <option value="2">2 pola (Poziom 2)</option>
                        <option value="3">3 pola (Poziom 3)</option>
                        <option value="4">4 pola (Poziom 4)</option>
                        <option value="5">5 p√≥l (Poziom 5)</option>
                        <option value="6">6+ p√≥l (Poziom 6+)</option>
                    </select>
                </div>
            </div>

            <!-- Sekcja 3: Wie≈ºa -->
            <div class="section">
                <h3>‚ôñ Wie≈ºa</h3>
                <div style="font-size: 0.9em; margin-bottom: 15px;">
                    <b>Jak nie wiesz, to kliknij tu =></b> <a href="https://lichess.org/learn#/1" target="_blank"
                        style="color: #667eea; text-decoration: none; font-size: 1.5em; vertical-align: middle;"
                        title="Lichess Rook Tutorial">‚ôñ</a>
                </div>
                <div class="question">
                    <label>≈Åamig≈Ç√≥wki z biciem wie≈ºƒÖ:</label>
                    <select name="rook_puzzles" required style="width: 50%;">
                        <option value="">Wybierz...</option>
                        <option value="1">RozwiƒÖzujƒô na 4 ruchy (Poziom 2)</option>
                        <option value="2">RozwiƒÖzujƒô na 5 ruch√≥w (Poziom 3)</option>
                        <option value="3">RozwiƒÖzujƒô na 6 ruch√≥w (Poziom 4)</option>
                        <option value="4">RozwiƒÖzujƒô na 7 ruch√≥w (Poziom 5)</option>
                        <option value="5">RozwiƒÖzujƒô na 8+ ruch√≥w (Poziom 6)</option>
                    </select>
                </div>
            </div>

            <!-- Sekcja 4: Hetman -->
            <div class="section">
                <h3>‚ôï Hetman</h3>
                <div style="font-size: 0.9em; margin-bottom: 15px;">
                    <b>Jak nie wiesz, to kliknij tu =></b> <a href="https://lichess.org/learn#/3/1" target="_blank"
                        style="color: #667eea; text-decoration: none; font-size: 1.5em; vertical-align: middle;"
                        title="Lichess Queen Tutorial">‚ôï</a>
                </div>
                <div class="question">
                    <label>≈Åamig≈Ç√≥wki z biciem hetmanem:</label>
                    <select name="queen_puzzles" required style="width: 50%;">
                        <option value="">Wybierz...</option>
                        <option value="1">RozwiƒÖzujƒô na 4 ruchy (Poziom 2)</option>
                        <option value="2">RozwiƒÖzujƒô na 5 ruch√≥w (Poziom 3)</option>
                        <option value="3">RozwiƒÖzujƒô na 6 ruch√≥w (Poziom 4)</option>
                        <option value="4">RozwiƒÖzujƒô na 7 ruch√≥w (Poziom 5)</option>
                        <option value="5">RozwiƒÖzujƒô na 8+ ruch√≥w (Poziom 6)</option>
                    </select>
                </div>
            </div>

            <!-- Sekcja 5: Skoczek -->
            <div class="section">
                <h3>‚ôò Skoczek</h3>
                <div style="font-size: 0.9em; margin-bottom: 15px;">
                    <b>Jak nie wiesz, to kliknij tu =></b> <a href="https://mwfund.github.io/skoczek/skoczek.html"
                        target="_blank"
                        style="color: #667eea; text-decoration: none; font-size: 1.5em; vertical-align: middle;"
                        title="Gra Skoczek">‚ôò</a>
                </div>
                <div class="question">
                    <label>"Problem skoczka szachowego" - ile p√≥l wype≈Çniasz?</label>
                    <select name="knight_problem" required style="width: 50%;">
                        <option value="">Wybierz...</option>
                        <option value="2">40-49 p√≥l (Poziom 2)</option>
                        <option value="3">50-53 pola (Poziom 3)</option>
                        <option value="4">54-55 p√≥l (Poziom 4)</option>
                        <option value="5">56-57 p√≥l (Poziom 5)</option>
                        <option value="6">58-61 p√≥l (Poziom 6-7)</option>
                        <option value="7">62-63 pola (Poziom 8)</option>
                        <option value="8">64 pola (Poziom 9)</option>
                    </select>
                </div>
                <div class="question" style="display: none;">
                    <label>Gra Troyis - jaki poziom przechodzisz?</label>
                    <select name="troyis" style="width: 50%;">
                        <option value="0" selected>Wybierz...</option>
                        <option value="2">Poziom 2</option>
                        <option value="3">Poziom 3</option>
                        <option value="4">Poziom 4</option>
                        <option value="5">Poziom 7</option>
                        <option value="6">Poziom 9+</option>
                    </select>
                </div>
            </div>

            <!-- Sekcja 6: Kr√≥l i Pion -->
            <div class="section">
                <h3>‚ôî Kr√≥l i ‚ôô Pion</h3>
                <div style="font-size: 0.9em; margin-bottom: 15px;">
                    <b>Jak nie wiesz, to kliknij tu =></b> <a href="https://lichess.org/learn#/15" target="_blank"
                        style="color: #667eea; text-decoration: none; font-size: 1.5em; vertical-align: middle;"
                        title="Lichess King & Pawn">‚ôî</a>
                </div>
                <div class="question">
                    <label>Ruch kr√≥lem - znajomo≈õƒá atakowanych p√≥l:</label>
                    <select name="king_knowledge" required style="width: 50%;">
                        <option value="">Wybierz...</option>
                        <option value="1">Znam podstawowe ruchy (Poziom 1)</option>
                        <option value="3">Wskazujƒô pola atakowane przez 1 bierkƒô (Poziom 3)</option>
                        <option value="4">Wskazujƒô pola atakowane przez 2 bierki (Poziom 4)</option>
                        <option value="5">Wskazujƒô pola atakowane przez 3 bierki (Poziom 5)</option>
                    </select>
                </div>
                <div class="question">
                    <label>Znajomo≈õƒá ruch√≥w specjalnych piona:</label>
                    <select name="pawn_special" required style="width: 50%;">
                        <option value="">Wybierz...</option>
                        <option value="1">Znam podstawy (Poziom 1)</option>
                        <option value="2">Znam promocjƒô (Poziom 2)</option>
                        <option value="3">Znam en passant (Poziom 3)</option>
                    </select>
                </div>
            </div>

            <!-- Sekcja 7: Warto≈õƒá materialna -->
            <div class="section">
                <h3>üíé Warto≈õƒá materialna figur</h3>
                <div style="font-size: 0.9em; margin-bottom: 15px;">
                    <b>Jak nie wiesz, to kliknij tu =></b> <a href="https://mwfund.github.io/Matma/szachomatma.html"
                        target="_blank"
                        style="color: #667eea; text-decoration: none; font-size: 1.5em; vertical-align: middle;"
                        title="Warto≈õƒá materialna figur">üíé</a>
                </div>
                <div class="question">
                    <label>Obliczanie warto≈õci bierek:</label>
                    <select name="material_value" required style="width: 50%;">
                        <option value="">Wybierz...</option>
                        <option value="1">Znam warto≈õci (Poziom 1)</option>
                        <option value="2">Dzia≈Çania na 2 bierkach (Poziom 2)</option>
                        <option value="3">Dzia≈Çania na 3 bierkach (Poziom 3)</option>
                        <option value="4">Dzia≈Çania na 4 bierkach (Poziom 4)</option>
                        <option value="5">Dzia≈Çania na 5 bierkach (Poziom 5)</option>
                        <option value="7">Dzia≈Çania na 6 bierkach (Poziom 7)</option>
                        <option value="9">Dzia≈Çania na 7+ bierkach (Poziom 9)</option>
                    </select>
                </div>
            </div>

            <!-- Sekcja 8: Szach i mat -->
            <div class="section">
                <h3>‚öîÔ∏è Szach, Mat i Pat</h3>
                <div style="font-size: 0.9em; margin-bottom: 15px;">
                    <b>Jak nie wiesz, to kliknij tu =></b> <a href="https://lichess.org/learn#/16" target="_blank"
                        style="color: #667eea; text-decoration: none; font-size: 1.5em; vertical-align: middle;"
                        title="Lichess Check">‚öîÔ∏è</a>
                    <a href="https://lichess.org/learn#/11" target="_blank"
                        style="color: #667eea; text-decoration: none; font-size: 1.5em; vertical-align: middle;"
                        title="Lichess Mate in 1">üèÅ</a>
                </div>
                <div class="question">
                    <label>Rozpoznawanie i wykonywanie szacha:</label>
                    <select name="check_knowledge" required style="width: 50%;">
                        <option value="">Wybierz...</option>
                        <option value="1">Rozpoznajƒô szacha (Poziom 1)</option>
                        <option value="2">Wykonujƒô szacha i znam obronƒô (Poziom 2)</option>
                        <option value="3">Wskazujƒô wszystkie mo≈ºliwe szachy (Poziom 3)</option>
                        <option value="4">Znajdujƒô wszystkie obrony (Poziom 4)</option>
                    </select>
                </div>
                <div class="question">
                    <label>Umiejƒôtno≈õƒá matowania:</label>
                    <select name="mate_ability" required style="width: 50%;">
                        <option value="">Wybierz...</option>
                        <option value="1">Rozpoznajƒô mata (Poziom 1)</option>
                        <option value="2">Mat w 1 posuniƒôciu z podpowiedziƒÖ (Poziom 2)</option>
                        <option value="3">Mat w 1 posuniƒôciu bez podpowiedzi (Poziom 3-4)</option>
                        <option value="5">Proste maty w 2 posuniƒôciach (Poziom 5)</option>
                    </select>
                </div>
                <div class="question">
                    <label>Matowanie hetmanem/wie≈ºƒÖ:</label>
                    <select name="endgame" required style="width: 50%;">
                        <option value="">Wybierz...</option>
                        <option value="1">Znam schemat (Poziom 1)</option>
                        <option value="2">Matujƒô w < 50 posuniƒôƒá (Poziom 2)</option>
                        <option value="3">Matujƒô w < 30 posuniƒôƒá (Poziom 3)</option>
                        <option value="4">Matujƒô w < 15 posuniƒôƒá (Poziom 4)</option>
                        <option value="5">Matujƒô w < 10 posuniƒôƒá (Poziom 5)</option>
                    </select>
                </div>
            </div>

            <!-- Sekcja 9: Roszada -->
            <div class="section">
                <h3>üè∞ Roszada</h3>
                <div style="font-size: 0.9em; margin-bottom: 15px;">
                    <b>Jak nie wiesz, to kliknij tu =></b> <a href="https://lichess.org/learn#/14/3" target="_blank"
                        style="color: #667eea; text-decoration: none; font-size: 1.5em; vertical-align: middle;"
                        title="Lichess Castling Tutorial">üè∞</a>
                </div>
                <div class="question">
                    <label>Znajomo≈õƒá roszady:</label>
                    <select name="castling" required style="width: 50%;">
                        <option value="">Wybierz...</option>
                        <option value="1">Znam i potrafiƒô wykonaƒá (Poziom 1)</option>
                        <option value="2">Wskazujƒô mo≈ºliwe roszady - proste (Poziom 2)</option>
                        <option value="3">Wskazujƒô mo≈ºliwe roszady - trudniejsze (Poziom 3)</option>
                        <option value="4">RozwiƒÖzujƒô ≈Çamig≈Ç√≥wki z roszadƒÖ (Poziom 4-5)</option>
                    </select>
                </div>
            </div>

            <button type="submit" class="submit-btn">üéØ Sprawd≈∫ m√≥j poziom!</button>
        </form>

        <div id="results"></div>
    </div>

    <script>
        document.getElementById('examForm').addEventListener('submit', function (e) {
            e.preventDefault();

            const formData = new FormData(e.target);
            const answers = {};

            for (let [key, value] of formData.entries()) {
                answers[key] = parseInt(value);
            }

            // Obliczanie poziomu dla ka≈ºdej kategorii
            const categories = {
                'Szachownica': Math.max(
                    Math.floor(answers.board_fields / 2) + 3,
                    answers.board_knowledge
                ),
                'Goniec': Math.min(answers.bishop_puzzles + 1, answers.bishop_memory),
                'Wie≈ºa': answers.rook_puzzles + 1,
                'Hetman': answers.queen_puzzles + 1,
                'Skoczek': Math.max(answers.knight_problem, answers.troyis),
                'Kr√≥l i Pion': Math.max(answers.king_knowledge, answers.pawn_special),
                'Warto≈õƒá materialna': answers.material_value,
                'Szach i Mat': Math.max(answers.check_knowledge, answers.mate_ability, answers.endgame),
                'Roszada': answers.castling
            };

            // Znajdowanie minimalnego poziomu (aktualny poziom ucznia)
            const levels = Object.values(categories);
            const currentLevel = Math.min(...levels);
            const avgLevel = Math.round(levels.reduce((a, b) => a + b, 0) / levels.length);

            // Znajdowanie s≈Çabych obszar√≥w
            const weaknesses = Object.entries(categories)
                .filter(([_, level]) => level === currentLevel)
                .map(([cat, _]) => cat);

            // Analiza mo≈ºliwo≈õci awansu
            const improvements = analyzeImprovements(categories, currentLevel);

            displayResults(currentLevel, avgLevel, categories, weaknesses, improvements);
        });

        function analyzeImprovements(categories, currentLevel) {
            const improvements = [];
            const sortedCategories = Object.entries(categories)
                .sort((a, b) => a[1] - b[1]);

            // Sprawd≈∫ co siƒô stanie je≈õli poprawi 1 aspekt
            for (let i = 1; i <= 3; i++) {
                const improved = { ...categories };
                let description = [];

                for (let j = 0; j < i && j < sortedCategories.length; j++) {
                    improved[sortedCategories[j][0]] = sortedCategories[j][1] + 1;
                    description.push(sortedCategories[j][0]);
                }

                const newLevel = Math.min(...Object.values(improved));

                if (newLevel > currentLevel) {
                    improvements.push({
                        count: i,
                        newLevel: newLevel,
                        categories: description
                    });
                }
            }

            return improvements;
        }

        function displayResults(currentLevel, avgLevel, categories, weaknesses, improvements) {
            const resultsDiv = document.getElementById('results');

            let html = `
                <div class="result-header">
                    <h2>üéì Twoje wyniki</h2>
                    <div class="level-badge">POZIOM ${currentLevel}</div>
                    <p>≈öredni wynik we wszystkich kategoriach: ${avgLevel.toFixed(1)}</p>
                </div>
                
                <div class="badge-container">
                    <div class="badge-visual">
                        <img src="przypinka_clear.png" alt="Odznaka szachowa" class="badge-image">
                        <div class="anim-grid">
                            ${generateBadgeCells(currentLevel)}
                        </div>
                    </div>
                </div>
                
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-box" style="background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);"></div>
                        <span>Zdobyte poziomy</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-box" style="background: rgba(200, 200, 200, 0.3); border: 2px solid rgba(100, 100, 100, 0.2);"></div>
                        <span>Do zdobycia</span>
                    </div>
                </div>
                
                <div class="stats">
                    <div class="stat-card">
                        <div class="stat-value">${currentLevel}/9</div>
                        <div class="stat-label">Aktualny poziom</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${avgLevel.toFixed(1)}</div>
                        <div class="stat-label">≈örednia</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${weaknesses.length}</div>
                        <div class="stat-label">Obszary do poprawy</div>
                    </div>
                </div>
                
                <div class="category-results">
                    <h3>üìä Szczeg√≥≈Çowe wyniki w kategoriach</h3>
                    ${generateCategoryBars(categories)}
                </div>
                
                <div class="weakness-list">
                    <h4>‚ö†Ô∏è Obszary wymagajƒÖce poprawy (na poziomie ${currentLevel}):</h4>
                    <ul>
                        ${weaknesses.map(w => `<li>${w}</li>`).join('')}
                    </ul>
                </div>
                
                <div class="improvement-section">
                    <h3>üöÄ Mo≈ºliwo≈õci awansu</h3>
                    <p>Oto jak szybko mo≈ºesz awansowaƒá poprawiajƒÖc wybrane umiejƒôtno≈õci:</p>
                    ${generateImprovementOptions(improvements, currentLevel)}
                </div>
                
                <div class="action-buttons">
                    <button class="action-btn btn-reset" onclick="resetTest()">üîÑ Zako≈Ñcz test</button>
                    <button class="action-btn btn-save" onclick="saveToPDF()">üíæ Zapisz wynik</button>
                </div>
            `;

            resultsDiv.innerHTML = html;
            resultsDiv.style.display = 'block';

            // Animacja wype≈Çnienia pask√≥w
            setTimeout(() => {
                document.querySelectorAll('.bar-fill').forEach(bar => {
                    bar.style.width = bar.dataset.width;
                });
            }, 100);

            // Scroll do wynik√≥w
            resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function generateBadgeCells(level) {
            let cells = '';
            for (let i = 1; i <= 9; i++) {
                const litClass = i <= level ? 'lit' : '';
                cells += `<div class="anim-cell ${litClass}"></div>`;
            }
            return cells;
        }

        function generateCategoryBars(categories) {
            let html = '';
            for (let [category, level] of Object.entries(categories)) {
                const percentage = (level / 9) * 100;
                html += `
                    <div class="category-bar">
                        <div class="category-name">${category}</div>
                        <div class="bar-container">
                            <div class="bar-fill" data-width="${percentage}%" style="width: 0%">
                                ${level}/9
                            </div>
                        </div>
                    </div>
                `;
            }
            return html;
        }

        function generateImprovementOptions(improvements, currentLevel) {
            if (improvements.length === 0) {
                return '<p style="color: #28a745; font-weight: bold;">üéâ Gratulacje! OsiƒÖgnƒÖ≈Çe≈õ maksymalny poziom we wszystkich kategoriach!</p>';
            }

            let html = '';
            const labels = ['jeden', 'dwa', 'trzy'];

            improvements.forEach(imp => {
                const gain = imp.newLevel - currentLevel;
                html += `
                    <div class="improvement-option">
                        <h4>‚ú® Popraw ${labels[imp.count - 1]} ${imp.count === 1 ? 'aspekt' : 'aspekty'} ‚Üí Awans do poziomu ${imp.newLevel} (+${gain})</h4>
                        <p><strong>Skup siƒô na:</strong> ${imp.categories.join(', ')}</p>
                        <p>PoprawiajƒÖc te umiejƒôtno≈õci do poziomu ${currentLevel + 1}, automatycznie awansujesz!</p>
                    </div>
                `;
            });

            return html;
        }
    </script>

    <script>
        // Animacja sekwencyjnego zapalania poziom√≥w na odznace
        (function () {
            const cells = document.querySelectorAll('#animGrid .anim-cell');
            const totalCells = cells.length; // 9
            let currentStep = 0;
            const LIGHT_INTERVAL = 400;  // co ile ms zapala siƒô kolejny
            const PAUSE_ALL_LIT = 1200;  // pauza gdy wszystkie zapalone
            const PAUSE_ALL_OFF = 600;   // pauza gdy wszystkie zgaszone

            function lightNext() {
                if (currentStep < totalCells) {
                    cells[currentStep].classList.add('lit');
                    currentStep++;
                    setTimeout(lightNext, LIGHT_INTERVAL);
                } else {
                    // Wszystkie zapalone ‚Äî pauza, potem zga≈õ
                    setTimeout(function () {
                        cells.forEach(c => c.classList.remove('lit'));
                        currentStep = 0;
                        setTimeout(lightNext, PAUSE_ALL_OFF);
                    }, PAUSE_ALL_LIT);
                }
            }

            lightNext();
        })();

        // Funkcja resetowania testu
        function resetTest() {
            if (confirm('Czy na pewno chcesz zako≈Ñczyƒá test i wr√≥ciƒá do poczƒÖtku?')) {
                location.reload();
            }
        }

        // Funkcja zapisu do PDF
        function saveToPDF() {
            // Pobierz imiƒô ucznia
            const studentName = document.getElementById('studentName').value || 'Ucze≈Ñ';

            // Ustaw tytu≈Ç dokumentu
            const originalTitle = document.title;
            document.title = `Wynik_${studentName.replace(/\s+/g, '_')}_${new Date().toLocaleDateString('pl-PL')}`;

            // Ukryj formularz przed drukiem
            const form = document.getElementById('examForm');
            const formDisplay = form.style.display;
            form.style.display = 'none';

            // Wywo≈Çaj okno druku
            window.print();

            // Przywr√≥ƒá widoczno≈õƒá formularza i tytu≈Ç
            form.style.display = formDisplay;
            document.title = originalTitle;
        }
    </script>
</body>

</html>
